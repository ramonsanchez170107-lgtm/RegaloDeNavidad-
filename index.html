<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Regalo para Dana ‚Äî De Luis S√°nchez Fuentes</title>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Montserrat:wght@300;500&display=swap" rel="stylesheet">

<style>
  *{box-sizing:border-box;margin:0;padding:0}
  html,body{height:100%}
  body{font-family: 'Montserrat', sans-serif; color:#fff; min-height:100vh; overflow:hidden; background:#000; position:relative;}

  /* Fullscreen map background */
  #map{position:fixed; inset:0; z-index:0}
  .leaflet-container{background:#000}

  /* Phrase box in the top-right corner so the map remains visible */
  .phrase-box{
    position:fixed;
    top:16px;
    right:16px;
    z-index:6;
    width:36%;
    min-width:220px;
    max-width:480px;
    background: rgba(0,0,0,0.20);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    border-radius:12px;
    padding:14px 16px 46px 16px; /* space for watermark */
    box-shadow: 0 10px 30px rgba(0,0,0,0.45);
    color: #fff;
    text-align:left;
  }
  .phrase-title{
    font-family: 'Great Vibes', cursive;
    font-size:1.6rem;
    margin-bottom:8px;
    color:#ffeef4;
    text-shadow: 0 4px 12px rgba(0,0,0,0.6);
  }
  .phrase-text{ font-size:1rem; line-height:1.5; margin-bottom:10px; color:#fff; text-shadow:0 2px 8px rgba(0,0,0,0.5); min-height:120px; }

  /* subtle watermark (added only in final) */
  .watermark{
    position:absolute;
    right:12px;
    bottom:8px;
    z-index:7;
    font-size:0.88rem;
    opacity:0.16;
    pointer-events:none;
    color:#fff;
    font-weight:700;
    font-family: 'Montserrat', sans-serif;
  }

  /* Corner ornaments (bottom-left) - emojis instead of images */
  .corner-ornaments{
    position:fixed;
    left:14px;
    bottom:14px;
    z-index:6;
    display:flex;
    gap:10px;
    align-items:center;
    padding:8px 10px;
    border-radius:12px;
    pointer-events:none;
    background: rgba(255,255,255,0.02);
    box-shadow: 0 12px 36px rgba(0,0,0,0.45);
    backdrop-filter: blur(4px);
  }
  .ornament{
    display:inline-block;
    font-size:30px;
    line-height:1;
    transform-origin: 50% 50%;
    will-change: transform, opacity;
    text-shadow: 0 6px 18px rgba(0,0,0,0.6);
    opacity: 0.95;
    user-select: none;
  }

  /* gentle float animation for ornaments */
  @keyframes ornamentFloat {
    0% { transform: translateY(0) rotate(-4deg) }
    50% { transform: translateY(-8px) rotate(4deg) }
    100% { transform: translateY(0) rotate(-4deg) }
  }
  .ornament { animation: ornamentFloat 4.2s ease-in-out infinite; }

  .controls{ display:flex; justify-content:flex-end; gap:8px; margin-top:6px; }
  button.next{ background:#c9184a; border:0; color:#fff; padding:10px 18px; border-radius:999px; font-size:0.96rem; cursor:pointer; box-shadow:0 8px 20px rgba(201,24,74,0.12); }
  button.next:active{ transform:translateY(1px); }
  button.next[disabled]{ opacity:.6; cursor:not-allowed; }

  /* Marker label styles for ME / YOU (visual only) */
  .marker-label{
    display:inline-block;
    padding:6px 10px;
    background: linear-gradient(180deg,#ff7aa5,#ff4f7a);
    color:#fff;
    font-weight:700;
    border-radius:10px;
    box-shadow: 0 6px 18px rgba(0,0,0,0.35);
    font-size:0.95rem;
  }

  /* Final title clearer */
  .final-title{
    font-family: 'Great Vibes', cursive;
    font-size:2.8rem;
    color:#fff;
    text-shadow: 0 8px 30px rgba(0,0,0,0.6);
    margin-bottom:10px;
    text-align:center;
  }
  .final-sub{
    text-align:center;
    font-size:1.05rem;
    opacity:0.95;
    margin-top:6px;
  }

  /* Decorative final hearts (falling) */
  .heart{ position:fixed; z-index:7; pointer-events:none; font-size:20px; animation: float 6s linear forwards; }
  @keyframes float{ 0%{ transform: translateY(-20vh) scale(.6); opacity:0 } 10%{ opacity:1 } 100%{ transform: translateY(110vh) scale(1.1); opacity:0 } }

  @media (max-width:720px){
    .phrase-box{ width:68%; top:12px; right:12px; padding:12px 14px 40px 12px; min-width:160px; }
    .phrase-title{ font-size:1.3rem; }
    .corner-ornaments{ left:10px; bottom:12px; padding:6px; gap:8px; }
    .ornament{ font-size:26px; }
  }

  @media (prefers-reduced-motion: reduce){
    .heart { animation:none !important; }
    .ornament { animation:none !important; transform:none !important; }
  }
</style>
</head>
<body>

<div id="map" aria-hidden="true"></div>

<!-- Phrase box (top-right) -->
<div class="phrase-box" id="phraseBox" aria-live="polite" role="region">
  <div class="phrase-title" id="phraseTitle">Feliz Navidad, Dana üéÑ‚ù§Ô∏è</div>
  <div class="phrase-text" id="phraseText">...</div>
  <div class="controls"><button id="nextBtn" class="next" type="button">Siguiente</button></div>
  <!-- watermark holder (added only on final) -->
  <div id="watermark" class="watermark" style="display:none;">De Luis para Dana</div>
</div>

<!-- Corner ornaments (emojis) -->
<div id="ornaments" class="corner-ornaments" aria-hidden="true"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
/* -------- Slides (texto + emojis como adorno) --------
   Ahora las "im√°genes" se sustituyen por emojis decorativos en la esquina.
*/
const slides = [
  {
    title: "Un regalo para ti",
    text: "Prepar√© este regalo pensando en las luces de diciembre y en la sorpresa de verte sonre√≠r. Es un detalle sencillo, hecho con mucho cari√±o: cuando el tiempo es poco, quiero que estos momentos sirvan para recordarte cu√°nto te pienso.",
    ornaments: ['üíñ','üéÑ','‚ú®']
  },
  {
    title: "Luces y calor",
    text: "Aunque nuestros d√≠as sean ocupados y los minutos cortos, cada llamada y cada mensaje convierten lo ordinario en extraordinario. Gracias por tu buen humor, por las risas inesperadas y por volver siempre a mi lado.",
    ornaments: ['‚ù§Ô∏è','üåü','üéÅ']
  },
  {
    title: "De ciudad a ciudad",
    text: "Entre Chicago y Guadalajara tejimos una historia divertida y c√°lida, con encuentros cortos y recuerdos largos. Este mapa muestra la distancia, pero lo que nos mantiene cerca son las ganas, el cari√±o y la paciencia.",
    ornaments: ['üíû','üß≠','‚úàÔ∏è']
  },
  {
    title: "Gracias por estar",
    text: "Gracias por volver, por elegir compartir este camino conmigo. Espero que disfrutes esta Navidad, y que pronto podamos celebrarla juntos, lado a lado.",
    ornaments: ['ü§ç','üé∂','üîî']
  },
  {
    title: "Con todo mi amor",
    text: "Que esta fiesta nos encuentre cerca y llenos de esperanza. Este regalo es peque√±o, pero el amor que lo sostiene es inmenso.",
    ornaments: ['üòò','üéÑ','üí´']
  }
];

/* -------- DOM references -------- */
const phraseTitle = document.getElementById('phraseTitle');
const phraseText = document.getElementById('phraseText');
const ornamentsEl = document.getElementById('ornaments');
const nextBtn = document.getElementById('nextBtn');
const watermarkEl = document.getElementById('watermark');

let current = 0;

/* ---------- Typewriter helper (cancels previous) ---------- */
function typeWriterInto(el, text, speed = 28) {
  if (el._typingTimeout) { clearTimeout(el._typingTimeout); el._typingTimeout = null; }
  el._typingIndex = 0;
  el.textContent = '';
  function step(){
    if (el._typingIndex === null) return;
    if (el._typingIndex < text.length){
      el.textContent += text.charAt(el._typingIndex);
      el._typingIndex++;
      el._typingTimeout = setTimeout(step, speed);
    } else {
      el._typingTimeout = null;
      el._typingIndex = null;
    }
  }
  step();
}

/* ---------- Render ornaments (emoji decorations) ---------- */
function renderOrnaments(list){
  // clear previous
  ornamentsEl.innerHTML = '';
  if (!Array.isArray(list) || list.length === 0) return;
  // add each emoji with a slight stagger in animation delay
  list.forEach((ch, i) => {
    const d = document.createElement('div');
    d.className = 'ornament';
    d.textContent = ch;
    // stagger the float animation for organic movement
    d.style.animationDelay = (i * 0.12) + 's';
    // vary size slightly for visual interest
    const scale = 1 + (Math.random() - 0.5) * 0.14;
    d.style.transform = `scale(${scale})`;
    ornamentsEl.appendChild(d);
  });
}

/* ---------- Show slide ---------- */
function showSlide(index){
  if(index < 0) index = 0;
  if(index >= slides.length) index = slides.length - 1;
  current = index;

  phraseTitle.textContent = slides[index].title;
  renderOrnaments(slides[index].ornaments || []);

  // hide watermark until final
  watermarkEl.style.display = 'none';

  // typewriter text
  typeWriterInto(phraseText, slides[index].text, 28);

  // update button label
  nextBtn.textContent = (index === slides.length - 1) ? 'Finalizar' : 'Siguiente';
  nextBtn.disabled = false;
}

/* ---------- Final celebration ---------- */
function showFinal(){
  phraseTitle.textContent = '';
  phraseText.innerHTML = `
    <div class="final-title">MERRY CHRISTMAS, Babe üéÑüòò</div>
    <div class="final-sub">Con todo mi amor.</div>
  `;
  nextBtn.disabled = true;

  // show subtle watermark only
  watermarkEl.style.display = 'block';

  // spawn many hearts across screen (visual only)
  const icons = ['‚ù§Ô∏è','üíñ','üéÑ','‚ú®','üéÅ','üòò','üåü','üîî'];
  for(let i=0;i<48;i++){
    const d = document.createElement('div');
    d.className = 'heart';
    d.textContent = icons[Math.floor(Math.random()*icons.length)];
    d.style.left = (5 + Math.random() * 90) + 'vw';
    d.style.fontSize = (14 + Math.random() * 36) + 'px';
    d.style.animationDuration = (3 + Math.random() * 4) + 's';
    document.body.appendChild(d);
    setTimeout(()=>d.remove(), 9000 + Math.random() * 3000);
  }
}

/* ---------- Next button ---------- */
nextBtn.addEventListener('click', () => {
  if(current >= slides.length - 1){
    showFinal();
    return;
  }
  showSlide(current + 1);
});

/* ---------- Leaflet map (non-interactive visual-only) ---------- */
const chicago = [41.8781, -87.6298];
const guadalajara = [20.6597, -103.3496];

const map = L.map('map', {
  center: [(chicago[0] + guadalajara[0]) / 2, (chicago[1] + guadalajara[1]) / 2],
  zoom: 4,
  zoomControl: false,
  attributionControl: false,
  dragging: false,
  scrollWheelZoom: false,
  doubleClickZoom: false,
  boxZoom: false,
  keyboard: false,
  touchZoom: false,
  tap: false
});

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 18 }).addTo(map);

/* labeled markers ME / YOU (visual only) */
function createLabelIcon(text){
  const el = document.createElement('div');
  el.className = 'marker-label';
  el.textContent = text;
  return L.divIcon({ html: el.outerHTML, className: '', iconSize: [70, 28], iconAnchor: [35, 14] });
}
L.marker(chicago, { icon: createLabelIcon('ME'), title: 'Chicago (ME)' }).addTo(map);
L.marker(guadalajara, { icon: createLabelIcon('YOU'), title: 'Guadalajara (YOU)' }).addTo(map);

/* dashed polyline for route */
const route = L.polyline([chicago, guadalajara], {
  color: '#ff6fa8',
  weight: 4,
  opacity: 0.95,
  dashArray: '12,10'
}).addTo(map);

map.fitBounds(route.getBounds(), { padding: [60,60] });

/* animate dashed stroke by changing strokeDashoffset */
let dashOffset = 0;
let dashRunning = true;
function animateDash(){
  const path = route._path;
  if(!path){
    setTimeout(animateDash, 120);
    return;
  }
  path.style.strokeDasharray = path.style.strokeDasharray || '12,10';
  const speed = 0.6;
  function step(){
    if(!dashRunning) return;
    dashOffset = (dashOffset + speed) % 1000;
    path.style.strokeDashoffset = dashOffset;
    requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}
setTimeout(animateDash, 400);

if(window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches){
  dashRunning = false;
}

/* ---------- Init ---------- */
showSlide(0);
</script>
</body>
</html>
